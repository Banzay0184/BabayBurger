#!/bin/bash

echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Django —Å–µ—Ä–≤–µ—Ä–∞..."

# –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã Django
echo "üõë –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Django –ø—Ä–æ—Ü–µ—Å—Å—ã..."
pkill -f "python manage.py runserver" 2>/dev/null || echo "–ü—Ä–æ—Ü–µ—Å—Å—ã Django –Ω–µ –Ω–∞–π–¥–µ–Ω—ã"

# –ñ–¥–µ–º –Ω–µ–º–Ω–æ–≥–æ
sleep 2

# –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä
echo "üöÄ –ó–∞–ø—É—Å–∫–∞–µ–º Django —Å–µ—Ä–≤–µ—Ä..."
python manage.py runserver 0.0.0.0:8000 &

# –ñ–¥–µ–º –∑–∞–ø—É—Å–∫–∞
sleep 3

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç
echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ—Ä–≤–µ—Ä..."
curl -s http://localhost:8000/api/test/ > /dev/null
if [ $? -eq 0 ]; then
    echo "‚úÖ Django —Å–µ—Ä–≤–µ—Ä —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω"
else
    echo "‚ùå –û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ Django —Å–µ—Ä–≤–µ—Ä–∞"
fi 